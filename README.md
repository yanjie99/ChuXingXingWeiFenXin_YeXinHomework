# ChuXingXingWeiFenXin_YeXinHomework
## Ye Xin’s  first homework , Q5 code
Q5:根据美国2017年亚利桑那州的NHTS出行调查数据，运行R代码，生成活动-出行模式数据，并进行时间分配与出行频率分析。区分通勤工作者（报告至少一次“工作”出行的人），通勤上学者（报告至少一次“上学”出行但没有报告任何“工作”出行的人）和非通勤者（没有报告任何“工作”或“上学”出行的人）。格式参考以下表格，出行目的或活动类型需要根据表一进行分类。


表1、变量whyfrom和whyto的出行目的定义和本作业规定的归类方法

![image](https://user-images.githubusercontent.com/56749463/142756618-5d7a9098-04c1-4020-a798-24481be51895.png)


通过在RStudio中运行Travel_AT.R，生成活动-出行模式的数据，存放在at.sav文件中，通过使用SPSS软件将该数据转化成CSV格式以便用Python进行数据分析与处理。

首先将数据按照通勤工作者、通勤上学者、和非通勤者分成三类数据，筛选条件为数据中出现至少一次“工作”出行的人，即ActType变量为（2，3，4，5）中任意一个，就规定为通勤工作者；报告至少一次“上学”出行但没有报告任何“工作”出行的人，即ActType变量为8，且不能等于（2，3，4，5）中任意一个，就归类为通勤上学者；没有报告任何“工作”或“上学”出行的人，即ActType变量中不等于（2，3，4，5，8）的人，就归类为非通勤者。通过Python完成以上筛选后生成3个数据文件，对应每一类的人的数据，即data_worker.csv、data_student.csv、data_nonworker.csv。

先分析每天平均活动时长。根据表一，分成8类活动，分别是：回家、工作、上学、购物、社交娱乐、就医、接送他人、和其它。一开始对三类人人数进行初步统计，得出通勤工作者、通勤上学者、非通勤者人数分别为：1339、388、1919；但是通过分析数据发现，数据中所收集的人的行为数据并非都为一天，有的是两天、三天不等，以为要求日均时长，所以对数据进行重新清洗统计，经调整后通勤工作者、通勤上学者、非通勤者人数分别为：2046、432、2196。完成以上工作后，对每个人就8小类活动进行时长的分析，在变量中时长放在变量AtDur中，平均活动时长就用总的AtDur值相加求和除以对应类别的人数，最终得到结果如下表所示。

在分析日均行程时长中，先根据变量ActType=-2，筛选出行程链，之后在根据行程链的时间差进行统计时长即可，最后求取平均得出结果。同时，在这一步中，对出行频次也可以一起分析出来，同样最后求取平均即可，所写的相应代码已存在文件YeXin5_DailyActivityTime.ipynb、YeXin5_TravelTime.ipynb、YeXin5_TripFrequency.ipynb中。

通过表可以得出，非通勤者平均每天在家时间最长，达到了1113.528min，其次是通勤上学者879.271min，最后是通勤工作者866.248。同时，通勤工作者每天平均工作时长367.704min，通勤上学者每日平均在校时长为394.81min，其中非通勤者平均每天将时间花费在了购物和社交娱乐上，平均花费时长分别为63.653min、118.974min。

通过分析每日在不同类型的行程上所消费的时间可以发现，通勤上班者在上下班路程上花费时间最多，其次便是购物消费时花费的行程时间。相应的，通勤上学者主要将行程时间花费在上下学上，其它类活动平均花费时间都比较少。而非通勤者将大量的行程时间用在购物和社交娱乐的路上，对应的花费在回家过程中的时长也就相应较高。

通过分析每日出行频率分析，通勤工作者平均工作出行达1.03次，通勤上学者平均上学出行达0.963次，非通勤者平均购物出行竟然达1.412次。在购物方面，通勤工作者日均出行次数也达到了0.907次，而通勤上学者在其它活动方面的出行都比较少。

![image](https://user-images.githubusercontent.com/56749463/142756684-69ebf95e-8ca2-4965-b2a5-ebafd7d8d84b.png)
